"""
Эксплуатационная практика МУИВ
Петроградский Вячеслав Максимович
Январь 2026 года
"""

import struct
from typing import Optional, Tuple, List

# Константы алгоритма
MIN_KEY_LEN = 1  # Минимальная длина ключа в байтах
MAX_KEY_LEN = 32  # Максимальная длина ключа в байтах
MAX_IV_LEN = 16  # Максимальная длина IV в байтах
KESTREAM_BLOCK = 80  # Размер блока гаммы в байтах, т.к. 4*4*5 32-битных слов

MASK_32BIT = 0xFFFFFFFF  # Маска для 32-битных операций

def rotate_left(val: int, shift: int) -> int:
    """
    Циклический сдвиг 32-битного числа влево.

    Исходные параметры:
        val: исходное 32-битное число
        shift: количество бит для сдвига (0-31)
    Результат на выходе:
        Число после циклического сдвига
    """
    return ((val << shift) & MASK_32BIT) | ((val & MASK_32BIT) >> (32 - shift))